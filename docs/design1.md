# Технологический стек

Этот документ подробно описывает технологический стек, выбранный для проекта в соответствии с **ADR-001**.

## Основная архитектура: Local-First

В основе проекта лежит "Local-First" подход. Это означает, что приложение в первую очередь работает с локальными данными на компьютере пользователя, не требуя постоянного подключения к интернету. Все данные (записи о персонажах, локациях и т.д.) хранятся непосредственно в файловой системе.

**Ключевые преимущества:**

- **Полный контроль и владение данными:** Пользователь не зависит от сторонних серверов.
- **Приватность:** Все наработки остаются на локальной машине.
- **Офлайн-доступ:** Приложение полностью функционально без доступа к сети.
- **Долговечность:** Данные хранятся в простом текстовом формате, что обеспечивает их доступность даже без самого приложения.

## Компоненты стека

Ниже представлена схема взаимодействия основных компонентов системы.

```text
+-----------------------------------+
|   Пользовательский интерфейс (UI) |
|          (React / Vue.js)         |
+-----------------------------------+
               ^ |
               | | API (Commands & Events)
               v |
+-----------------------------------+
|        Backend (Tauri/Rust)       |
|  - Работа с файловой системой     |
|  - Поиск и индексация             |
+-----------------------------------+
               ^ |
               | | Чтение/Запись
               v |
+-----------------------------------+
|      Хранилище: Папки-сущности    |
| /aragorn/                         |
|   ├── text.md                     |
|   └── meta.yml                    |
+-----------------------------------+
```

### 1. Оболочка приложения: Tauri

**Tauri** — это фреймворк для создания легковесных и безопасных кроссплатформенных десктопных приложений с использованием веб-технологий.

- **Почему Tauri?** В отличие от Electron, Tauri не встраивает в приложение полноценный браузер и Node.js, а использует системный webview. Это приводит к значительно меньшему размеру и потреблению памяти.
- **Роль в проекте:** Tauri создает "каркас" нашего десктоп-приложения. Его backend-часть, написанная на **Rust**, будет выполнять все операции, требующие доступа к системе: чтение и запись файлов, индексацию данных для поиска, взаимодействие с ОС. Это обеспечивает высокую производительность и безопасность.

### 2. Frontend: React или Vue.js

Пользовательский интерфейс будет построен на одном из современных JavaScript-фреймворков.

- **Роль в проекте:** Frontend будет отвечать за все, что видит и с чем взаимодействует пользователь. Он будет запрашивать данные у backend-части (Tauri/Rust) и отображать их в удобном виде: списки сущностей, их детальные описания, и, что самое важное, — визуальный граф связей между ними.

### 3. Хранение данных: Папка как сущность

Чтобы обеспечить максимальную совместимость со сторонними редакторами и не "загрязнять" основной текст, мы используем подход "Папка как сущность".

- **Структура:** Каждая сущность (персонаж, локация и т.д.) представляет собой отдельную папку. Внутри этой папки находятся как минимум два файла:
  - **`text.md`**: "Чистый" Markdown-файл, содержащий исключительно основной текст (повествование, описание). Он не содержит никаких служебных данных и идеально открывается в любом текстовом редакторе.
  - **`meta.yml`**: Файл в формате YAML, хранящий все метаданные: тип сущности, ее статус, теги, а также список всех связей с другими сущностями.

- **Преимущества:**
  - **Инкапсуляция:** Все, что связано с одной сущностью, находится в одном месте.
  - **Расширяемость:** Эта структура позволяет в будущем легко добавлять к сущности любые другие файлы (изображения, карты, черновики), просто поместив их в ту же папку.
  - **Надежность:** Управление файлами (создание, переименование папок) будет полностью автоматизировано приложением, что минимизирует риск ошибки со стороны пользователя.
