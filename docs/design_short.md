# Краткое описание архитектуры и технических решений

Этот документ содержит тезисное описание ключевых архитектурных решений проекта, основанных на [ADR-001](..\adrs\ADR1.md) и [ADR-002](..\adrs\ADR2.md).

## 1. Основной принцип: Local-First

- **Владение данными:** Все данные проекта хранятся локально на компьютере пользователя в виде обычных файлов и папок.
- **Автономность:** Приложение полностью функционально без подключения к интернету.
- **Долговечность:** Данные хранятся в простых текстовых форматах (Markdown, YAML), что обеспечивает их доступность даже без самого приложения.

## 2. Технологический стек

- **Оболочка приложения:** **Tauri**. Использует системный webview, что обеспечивает малый размер и низкое потребление ресурсов.
- **Бэкенд:** **Rust**. Выполняет все системные операции: работа с файловой системой, индексация, поиск. Обеспечивает производительность и безопасность.
- **Фронтенд:** Современный JS-фреймворк (например, **React**), отвечающий за весь пользовательский интерфейс и взаимодействие.

## 3. Модель хранения данных

- **Папка как сущность:** Каждая смысловая единица (персонаж, локация, глава) представляет собой отдельную папку на диске.
- **Структура сущности:** Внутри папки находятся следующие файлы:
  - `meta.yml`: Структурированные метаданные в формате YAML (свойства, поля, связи).
  - `text.md`: Основной, "чистовой" текст сущности в формате Markdown.
  - `plan.md` (опционально): План, наброски и общие заметки по сущности.
  - `notes.md` (опционально): Файл для сбора цитат и фрагментов текста, относящихся к данной сущности, из основного повествования.

## 4. Система типов (Гибридная модель)

- **Явное типирование:** Каждая сущность имеет обязательное поле `type` в своем `meta.yml` (например, `type: character`). Это поле является единственным источником истины о типе сущности.
- **Гибкость:** Сущность не привязана к своему расположению на диске. Поддерживаются множественные типы (`type: [character, king]`).
- **UI — основной интерфейс:** Пользователь работает с данными через графический интерфейс, который группирует сущности по их типу (например, "Персонажи", "Локации"), а не по папкам. Файловая структура является деталью реализации.
- **Специализированные инструменты:** UI предоставляет особые инструменты для работы со сложными данными, такими как упорядоченные списки (главы и эпизоды) и отношения между сущностями, абстрагируя сложность их хранения.
